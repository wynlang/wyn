fn compute(n: int) -> int {
    return n * n;
}

fn add(a: int, b: int) -> int {
    return a + b;
}

fn main() -> int {
    // Test 1: Basic spawn and await
    var f1 = spawn compute(42);
    var result1 = f1.await();
    if result1 != 1764 {
        return 1;
    }
    print(1);
    
    // Test 2: Multiple concurrent futures
    var f2 = spawn compute(10);
    var f3 = spawn compute(20);
    var f4 = spawn compute(30);
    var r2 = f2.await();
    var r3 = f3.await();
    var r4 = f4.await();
    if r2 != 100 || r3 != 400 || r4 != 900 {
        return 2;
    }
    print(2);
    
    // Test 3: Function with multiple arguments
    var f5 = spawn add(100, 200);
    var r5 = f5.await();
    if r5 != 300 {
        return 3;
    }
    print(3);
    
    // Test 4: Chained spawns
    var f6 = spawn compute(5);
    var r6 = f6.await();
    var f7 = spawn compute(r6);
    var r7 = f7.await();
    if r7 != 625 {
        return 4;
    }
    print(4);
    
    // Test 5: Out-of-order await
    var fa = spawn compute(1);
    var fb = spawn compute(2);
    var fc = spawn compute(3);
    var rc = fc.await();  // Await in reverse order
    var rb = fb.await();
    var ra = fa.await();
    if ra != 1 || rb != 4 || rc != 9 {
        return 5;
    }
    print(5);
    
    print(0);  // All tests passed
    return 0;
}
