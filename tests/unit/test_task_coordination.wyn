// Test: Task coordination
fn worker(id: int) -> int {
    var start = time_now();
    while time_now() - start < 50000000 {  // 50ms work
    }
    return id;
}

fn main() -> int {
    var task = task_create();
    
    var start = time_now();
    
    // Spawn 10 workers
    var i = 0;
    while i < 10 {
        task_spawn(task, worker(i));
        i = i + 1;
    }
    
    // Wait for all to complete
    task_wait(task);
    
    var elapsed = time_now() - start;
    
    // Should be ~50ms (parallel), not 500ms (sequential)
    if elapsed > 150000000 {
        return 1;  // FAIL
    }
    
    return 0;  // PASS
}
