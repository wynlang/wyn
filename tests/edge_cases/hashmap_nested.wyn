// Test nested HashMap: HashMap<string, HashMap<string, int>>
fn main() -> int {
    var outer_map = wyn_hashmap_new();
    
    print("Testing nested HashMap structure\n");
    
    // Create inner maps
    var inner1 = wyn_hashmap_new();
    var inner2 = wyn_hashmap_new();
    var inner3 = wyn_hashmap_new();
    
    // Populate inner maps
    wyn_hashmap_insert_int(inner1, "a", 10);
    wyn_hashmap_insert_int(inner1, "b", 20);
    wyn_hashmap_insert_int(inner1, "c", 30);
    
    wyn_hashmap_insert_int(inner2, "x", 100);
    wyn_hashmap_insert_int(inner2, "y", 200);
    
    wyn_hashmap_insert_int(inner3, "alpha", 1000);
    wyn_hashmap_insert_int(inner3, "beta", 2000);
    wyn_hashmap_insert_int(inner3, "gamma", 3000);
    
    // Store inner map handles in outer map
    wyn_hashmap_insert_int(outer_map, "group1", inner1);
    wyn_hashmap_insert_int(outer_map, "group2", inner2);
    wyn_hashmap_insert_int(outer_map, "group3", inner3);
    
    var outer_len = wyn_hashmap_len(outer_map);
    print("Outer map length: ");
    print(outer_len);
    print("\n");
    
    // Test accessing nested values
    if (wyn_hashmap_has(outer_map, "group1")) {
        var inner_handle = wyn_hashmap_get_int(outer_map, "group1");
        if (wyn_hashmap_has(inner_handle, "b")) {
            var val = wyn_hashmap_get_int(inner_handle, "b");
            print("outer['group1']['b'] = ");
            print(val);
            print("\n");
        }
    }
    
    if (wyn_hashmap_has(outer_map, "group2")) {
        var inner_handle = wyn_hashmap_get_int(outer_map, "group2");
        if (wyn_hashmap_has(inner_handle, "y")) {
            var val = wyn_hashmap_get_int(inner_handle, "y");
            print("outer['group2']['y'] = ");
            print(val);
            print("\n");
        }
    }
    
    if (wyn_hashmap_has(outer_map, "group3")) {
        var inner_handle = wyn_hashmap_get_int(outer_map, "group3");
        if (wyn_hashmap_has(inner_handle, "gamma")) {
            var val = wyn_hashmap_get_int(inner_handle, "gamma");
            print("outer['group3']['gamma'] = ");
            print(val);
            print("\n");
        }
    }
    
    // Test modifying nested values
    if (wyn_hashmap_has(outer_map, "group1")) {
        var inner_handle = wyn_hashmap_get_int(outer_map, "group1");
        wyn_hashmap_insert_int(inner_handle, "d", 40);
        var new_len = wyn_hashmap_len(inner_handle);
        print("Added 'd' to group1, new length: ");
        print(new_len);
        print("\n");
    }
    
    // Clean up - free inner maps first, then outer
    wyn_hashmap_free(inner1);
    wyn_hashmap_free(inner2);
    wyn_hashmap_free(inner3);
    wyn_hashmap_free(outer_map);
    
    print("Nested HashMap test completed\n");
    return 0;
}