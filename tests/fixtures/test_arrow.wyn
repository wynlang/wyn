// Test arrow tokenization

fn is_digit(ch: string) -> int {
    if ch == "0" { return 1 }
    if ch == "1" { return 1 }
    if ch == "2" { return 1 }
    if ch == "3" { return 1 }
    if ch == "4" { return 1 }
    if ch == "5" { return 1 }
    if ch == "6" { return 1 }
    if ch == "7" { return 1 }
    if ch == "8" { return 1 }
    if ch == "9" { return 1 }
    return 0
}

fn is_alpha(ch: string) -> int {
    if ch == "a" { return 1 }
    if ch == "b" { return 1 }
    if ch == "i" { return 1 }
    if ch == "n" { return 1 }
    if ch == "t" { return 1 }
    return 0
}

fn is_whitespace(ch: string) -> int {
    if ch == " " { return 1 }
    return 0
}

fn tokenize(input: string) -> int {
    var pos = 0
    var count = 0
    
    while pos < input.len() {
        var ch = input[pos]
        
        if is_whitespace(ch) {
            pos = pos + 1
        } else if is_digit(ch) {
            while pos < input.len() {
                if is_digit(input[pos]) {
                    pos = pos + 1
                } else {
                    break
                }
            }
            count = count + 1
        } else if is_alpha(ch) {
            while pos < input.len() {
                if is_alpha(input[pos]) {
                    pos = pos + 1
                } else {
                    break
                }
            }
            count = count + 1
        } else if ch == "-" {
            if pos + 1 < input.len() {
                if input[pos + 1] == ">" {
                    count = count + 1
                    pos = pos + 2
                    print("Found arrow at pos ")
                    print(pos - 2)
                } else {
                    count = count + 1
                    pos = pos + 1
                }
            } else {
                count = count + 1
                pos = pos + 1
            }
        } else {
            count = count + 1
            pos = pos + 1
        }
    }
    
    count = count + 1
    return count
}

fn main() -> int {
    var tokens = tokenize("a -> b")
    print("Token count: ")
    print(tokens)
    return 0
}
