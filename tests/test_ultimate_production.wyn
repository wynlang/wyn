// Ultimate production readiness test
fn main() -> int {
    var failures = 0
    
    print("=== ULTIMATE PRODUCTION TEST ===")
    
    // 1. Parse error detection
    var invalid = str_parse_int("not_a_number")
    if !str_parse_int_failed(invalid) {
        print("✗ Parse error detection")
        failures = failures + 1
    } else {
        print("✓ Parse error detection")
    }
    
    // 2. Array type safety
    var names: [string] = ["Alice", "Bob"]
    var first = names[0]
    if str_len(first) != 5 {
        print("✗ Array type safety")
        failures = failures + 1
    } else {
        print("✓ Array type safety")
    }
    
    // 3. String concatenation with numbers
    var num = 42
    var msg = "Number: " + int_to_str(num)
    if !str_contains(msg, "42") {
        print("✗ String concat with int_to_str")
        failures = failures + 1
    } else {
        print("✓ String concat with int_to_str")
    }
    
    // 4. File I/O
    file_write("/tmp/wyn_ultimate_test.txt", "test content")
    if !file_exists("/tmp/wyn_ultimate_test.txt") {
        print("✗ file_exists")
        failures = failures + 1
    } else {
        print("✓ file_exists")
    }
    
    var content = file_read("/tmp/wyn_ultimate_test.txt")
    if !str_contains(content, "test") {
        print("✗ file_read")
        failures = failures + 1
    } else {
        print("✓ file_read")
    }
    
    // 5. String operations
    var text = "HELLO"
    var lower = str_lower(text)
    var result = "Lower: " + lower
    if !str_contains(result, "hello") {
        print("✗ str_lower with concat")
        failures = failures + 1
    } else {
        print("✓ str_lower with concat")
    }
    
    // 6. char_at
    var ch = char_at("test", 0)
    if ch != "t" {
        print("✗ char_at")
        failures = failures + 1
    } else {
        print("✓ char_at")
    }
    
    // 7. split_get
    var part = split_get("a,b,c", ",", 1)
    if part != "b" {
        print("✗ split_get")
        failures = failures + 1
    } else {
        print("✓ split_get")
    }
    
    // 8. Real CSV processing
    var csv = "John,25,Engineer"
    var name = split_get(csv, ",", 0)
    var age_str = split_get(csv, ",", 1)
    var age = str_parse_int(age_str)
    if str_parse_int_failed(age) {
        print("✗ CSV processing")
        failures = failures + 1
    } else {
        var csv_msg = name + " is " + int_to_str(age)
        if !str_contains(csv_msg, "John is 25") {
            print("✗ CSV processing")
            failures = failures + 1
        } else {
            print("✓ CSV processing")
        }
    }
    
    // 9. Error recovery
    var e1 = str_parse_int("bad")
    var v1 = str_parse_int("10")
    if str_parse_int_failed(v1) {
        print("✗ Error recovery")
        failures = failures + 1
    } else {
        print("✓ Error recovery")
    }
    
    // 10. Large arrays
    var big: [int] = [1,2,3,4,5,6,7,8,9,10]
    var sum = 0
    var i = 0
    while i < 10 {
        sum = sum + big[i]
        i = i + 1
    }
    if sum != 55 {
        print("✗ Large arrays")
        failures = failures + 1
    } else {
        print("✓ Large arrays")
    }
    
    // 11. Nested operations
    var nested = int_to_str(str_parse_int(int_to_str(99)))
    if nested != "99" {
        print("✗ Nested operations")
        failures = failures + 1
    } else {
        print("✓ Nested operations")
    }
    
    // 12. File:: module syntax
    File::write("/tmp/wyn_module_test.txt", "module test")
    var module_content = File::read("/tmp/wyn_module_test.txt")
    if !str_contains(module_content, "module") {
        print("✗ File:: module syntax")
        failures = failures + 1
    } else {
        print("✓ File:: module syntax")
    }
    
    print("=================================")
    
    if failures == 0 {
        print("✅ ALL 12 TESTS PASSED")
        print("Wyn is PRODUCTION READY!")
        return 0
    }
    
    print("❌ FAILED: " + int_to_str(failures) + " tests")
    return 1
}
