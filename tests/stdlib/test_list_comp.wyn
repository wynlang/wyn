fn check_even(x: int) -> int { return x % 2 == 0 }

fn main() -> int {
    Test.init("List Comprehensions & Slices")
    
    // Basic list comprehension with range
    var squares = [x * x for x in 0..5]
    Test.assert_eq_int(squares.len(), 5, "comp len")
    Test.assert_eq_int(squares[0], 0, "comp [0]")
    Test.assert_eq_int(squares[4], 16, "comp [4]")
    
    // With filter
    var evens = [x for x in 0..10 if x % 2 == 0]
    Test.assert_eq_int(evens.len(), 5, "filtered len")
    Test.assert_eq_int(evens[0], 0, "filtered [0]")
    Test.assert_eq_int(evens[4], 8, "filtered [4]")
    
    // Expression body
    var doubled = [x * 2 for x in 1..6]
    Test.assert_eq_str(doubled.join(","), "2,4,6,8,10", "doubled")
    
    // Over existing array
    var nums = [10, 20, 30, 40, 50]
    var halved = [x / 2 for x in nums]
    Test.assert_eq_str(halved.join(","), "5,10,15,20,25", "from array")
    
    // Array comp with filter
    var big = [x for x in nums if x > 25]
    Test.assert_eq_int(big.len(), 3, "array filtered")
    Test.assert_eq_int(big[0], 30, "array filtered [0]")
    
    // Slice syntax with :
    var arr = [10, 20, 30, 40, 50]
    var s1 = arr[1:3]
    Test.assert_eq_int(s1.len(), 2, "slice : len")
    Test.assert_eq_int(s1[0], 20, "slice : [0]")
    
    // Slice syntax with ..
    var s2 = arr[2..5]
    Test.assert_eq_int(s2.len(), 3, "slice .. len")
    Test.assert_eq_int(s2[0], 30, "slice .. [0]")
    
    // String slice
    var str = "hello world"
    var sub = str[0:5]
    Test.assert_eq_str(sub, "hello", "string slice :")
    var sub2 = str[6..11]
    Test.assert_eq_str(sub2, "world", "string slice ..")
    
    Test.summary()
    return 0
}
